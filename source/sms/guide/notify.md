title: 通知类短信
---


## 准备工作
- 创建应用。首先，你需要在控制面板中创建应用。请参考 [控制面板-创建应用](/console/creat.html)。
- 账户充值。为防止滥用，短信服务需帐户余额大于 5 元才能使用。如余额不足，请进入 [控制面板-财务-充值](https://www.wilddog.com/pay/recharge) 进行充值。



## 配置短信

通知类短信需配置三部分: 签名、模版、变量。

### 配置签名

签名将出现在下发短信的开头，实际效果如下图中的【野狗实时】。签名可以是你的公司简称，品牌名或网站名。通过 控制面板-短信-签名 配置短信签名，同时需要提交相关资质，审核通过后可使用。

![](/images/tutorialsms.jpg)

<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>短信签名默认为【野狗试用】。</li>
  <li>每一个应用只能创建一个短信签名。</li>
  <li>更改签名需要在 控制面板-短信-签名 页面中提交相关资质。</li>
  <li>签名提交后需审核，在审核期间可以使用旧的签名发送短信。</li>
</blockquote>


### 配置模版


通知类模版需创建后提交审核。每个用户可以使用 [变量](/sms/guide/notify.html#配置变量) 来替换内容，每个应用最多创建 50 条通知类模版。过程如下：

![](/images/notifyprocess.jpg)


<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>通知类模版需要调用短信模板 id。</li>
</blockquote>

通过 控制面板-短信-模板 创建通知类短信内容模板，操作如下：

![](/images/mode.png)

#### 通知类模版使用场景

|场景        |  场景说明|
|--------------|----  |
|服务通知    |用户触发事件动作后，商家或者平台后台系统自动触发服务通知。服务开通、审核结果通知、报告结果反馈、刷卡消费通知等。|
|物流通知 |网购发货或者用户寄件以后，有商家或者物流公司发送发货通知、收货提醒等短信。|
|出票通知|O2O 配送、优惠券下发、航班信息、景区出票通知等等。|
|付款回执|用户进行充值、付款、转账、缴费、退款等行为后，系统实时发送短信提醒给用户。|
|活动确认|在线发起活动、活动报名、作品提交等环节，系统通过短信实时反馈给用户结果。|
|系统通知|系统运行状态通知、任务执行结果、优惠信息、维护公告、节假日问候等消息通过系统发送给用户。|

### 配置变量

野狗短信提供的模板短信由固定内容与多个变量构成，其中 `%s` 为需要接口替换的变量，发送短信时，接口会按顺序依次传入要替换的变量。

|参数           |类型           |必选       |说明|
|--------------|--------------|----------|---|
|params           |string         |否         |短信参数列表，用于依次填充模板，JSONArray格式，如["xxx","yyy"]；对于不包含变量的模板，表示模板即短信全文内容，无需传递此参数。|

<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>变量内容可以是汉字、字母、数字或者特殊字符。 </li>
  <li>单个变量内容长度不得超过30个字。</li>
  <li>一条模板短信中变量数量不限制，但不能连续使用5个变量。</li>
</blockquote>

例如，配置变量如下：

```
您有一个新的订单，订单编号为 %s。  此时params为 ["11111"]

```

#### 短信字符限制
短信可分为普通短信和长短信：

- 普通短信每条限制 70 个字符。

- 超过 70 个字符即为长短信，长短信最多支持 300 个字符。每条长短信将被拆分，其中每条信息限制为 67 个字符。

例如：一条 134 个字符的长短信，将被拆分为（67个字符+67个字符） 共2 条信息，同时按两条普通短信计费。

## 配置上行接口（选配）

配置上行接口后，野狗会将用户短信发送状态以及用户回复内容发送至该接口。可选择配置，默认关闭。

你需要提供一个公网可访问的 http 接口地址，在 控制面板-短信-用户回复 中配置为推送地址。如下：

![](/images/smsfeedback.jpg)

<blockquote class="notice">
  <p><strong>提示：</strong></p>
  <li>上行接口返回状态码200代表接收上行数据成功，返回其他状态码系统会进行重试</li>
  <li>如果连续 5 次接口请求失败，上行功能将被关闭，需要在控制面板重新开启。</li>
  <li>上行接口需要自行保证安全性，如校验rrid、mobile等参数是否合法，以防止恶意调用。</li>
  <li>因为网络原因，可能会导致上行推送重复提交，需要上行接口侧做好幂等操作</li>
</blockquote>

在返回状态或上行时，系统会调用该地址，将状态或上行以 JSON 形式进行推送，你应该获取整个 post 内容，进行数据解析。

例如，返回状态数据格式如下：

```
{
  "data": [
    {
      "status": "Success", //Success代表发送成功 Failure代表发送失败
      "deliveryStatus": "DELIVRD", //运营商状态码
      "mobile": "xxxxxxxxxxx",
      "rrid": "$rrid",
      "receiveTime": "2016-12-28 14:43:21"
    }
  ],
  "type": 1 //type为1代表状态类型
}
```

短信上行数据格式如下：

```
{
  "data": [
    {
      "content": "回复内容",
      "mobile": "xxxxxxxxxxx",
      "rrid": "$rrid",
      "receiveTime": "2016-12-28 15:18:30",
      "extno": "0001"
    }
  ],
  "type": 3 //type为3代表通知类或验证码类上行类型
}
```

## 调用接口
- 需生成 [数字签名](/sms/guide/signature.html#生成数字签名的方法) 及调用接口，请参考 [接口文档](/sms/api/send.html)。
- 如需查询短信发送状态，请参考 [查询发送状态](/sms/api/status.html)。

